<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evaluaci√≥n de Calidad - Colaboradores</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding: 20px;
  min-height: 100vh;
}
.container {
  max-width: 900px;
  margin: 0 auto;
  background: white;
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.2);
  overflow: hidden;
}
.header {
  background: #7a7a7a;
  color: white;
  padding: 30px;
  text-align: center;
}
.header h1 { font-size: 28px; margin-bottom: 8px; }
.header p { font-size: 14px; opacity: 0.95; }
.content { padding: 40px; }
.section {
  margin-bottom: 40px;
  padding-bottom: 30px;
  border-bottom: 2px solid #f0f0f0;
}
.section:last-child { border-bottom: none; }
.section-title {
  color: #667eea;
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 3px solid #667eea;
  display: inline-block;
}
.form-group { margin-bottom: 20px; }
label {
  display: block;
  font-weight: 600;
  margin-bottom: 8px;
  color: #333;
  font-size: 14px;
}
input[type="text"], input[type="date"], textarea, select {
  width: 100%;
  padding: 12px;
  border: 2px solid #e0e0e0;
  border-radius: 6px;
  font-size: 14px;
  transition: border-color 0.3s;
  font-family: inherit;
}
input:focus, textarea:focus, select:focus {
  outline: none;
  border-color: #667eea;
}
textarea { resize: vertical; min-height: 60px; }
input[readonly] { background-color: #f5f5f5; cursor: not-allowed; }
.criteria-item {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 8px;
  margin-bottom: 20px;
  border-left: 4px solid #667eea;
}
.criteria-title {
  font-weight: 600;
  color: #333;
  margin-bottom: 15px;
  font-size: 15px;
}
.criteria-option {
  margin-bottom: 10px;
  padding: 10px;
  background: white;
  border-radius: 6px;
  display: flex;
  align-items: flex-start;
}
.criteria-option input { margin-top: 3px; width: 18px; height: 18px; cursor: pointer; }
.criteria-option label { margin-left: 8px; margin-bottom: 0; font-weight: normal; line-height: 1.5; cursor: pointer; }
.option-cumple { border-left: 3px solid #28a745; }
.option-no-cumple { border-left: 3px solid #dc3545; }
.option-no-aplica { border-left: 3px solid #6c757d; }
.summary-box {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 8px;
  margin-top: 20px;
}
.summary-item {
  display: flex;
  justify-content: space-between;
  margin-bottom: 10px;
  padding: 8px;
  background: white;
  border-radius: 4px;
}
.summary-item strong { color: #333; }
.summary-item span { color: #667eea; font-weight: 600; }
.button-container {
  display: flex;
  gap: 15px;
  margin-top: 30px;
  justify-content: center;
  flex-wrap: wrap;
}
button {
  padding: 14px 30px;
  font-size: 16px;
  font-weight: 600;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.3s;
}
.btn-primary {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
}
.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 20px rgba(102,126,234,0.4);
}
.btn-secondary { background: #6c757d; color: white; }
.btn-secondary:hover { background: #5a6268; }
.two-column { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
@media (max-width: 768px) {
  .two-column { grid-template-columns: 1fr; }
  .content { padding: 20px; }
}
@media print {
  body { background: white; padding: 0; }
  .container { box-shadow: none; }
  .button-container { display: none !important; }
}
</style>
</head>
<body>
<div class="container">
<div class="header">
  <div style="display:flex; align-items:center; justify-content:center; gap:20px; flex-wrap:wrap;">
    <img src="data:image/png;base64,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" 
         alt="Training Logo" 
         style="height:120px; width:auto;">
    <div style="text-align:center;">
      <h1 style="margin:0; font-size:28px;">Formato de Evaluaci√≥n de Calidad</h1>
      <p style="margin:5px 0 0 0; font-size:14px; opacity:0.95;">Colaboradores Internos</p>
    </div>
  </div>
</div>
<div class="content">

<div class="section">
<h2 class="section-title">SECCI√ìN 1: DATOS DEL COLABORADOR</h2>
<div class="form-group">
<label>Selecciona al Colaborador:</label>
<select id="idColaborador"><option value="">Cargando...</option></select>
</div>
<div class="form-group">
<label>Nombre Completo:</label>
<input type="text" id="nombreColaborador" readonly />
</div>
<div class="two-column">
<div class="form-group">
<label>√Årea:</label>
<input type="text" id="areaColaborador" readonly />
</div>
<div class="form-group">
<label>Team Leader:</label>
<input type="text" id="teamLeader" placeholder="Ingrese Team Leader" />
</div>
</div>
<div class="form-group">
<label>Manager:</label>
<input type="text" id="managerColaborador" placeholder="Ingrese Manager" />
</div>
</div>

<div class="section">
<h2 class="section-title">SECCI√ìN 2: DATOS DEL CASO</h2>
<div class="form-group">
<label>Nombre del Cliente:</label>
<input type="text" id="nombreCliente" />
</div>
<div class="form-group">
<label>Tipo de Llamada:</label>
<select id="tipoLlamada">
<option value="">Seleccione tipo de llamada</option>
<option value="Agenda">Agenda</option>
<option value="Audit">Audit</option>
<option value="Call Back">Call Back</option>
<option value="Case Review">Case Review</option>
<option value="Deep Call">Deep Call</option>
<option value="Discovery Call">Discovery Call</option>
<option value="DOE's">DOE's</option>
<option value="Entrevista">Entrevista</option>
<option value="Llamadas de delitos">Llamadas de delitos</option>
<option value="LSU">LSU</option>
<option value="Master">Master</option>
<option value="Pre CR">Pre CR</option>
<option value="Pre WC">Pre WC</option>
<option value="Prep Call">Prep Call</option>
<option value="Psych Terapia">Psych Terapia</option>
<option value="Quick Call">Quick Call</option>
<option value="Removal">Removal</option>
<option value="Seguimiento a CL NC">Seguimiento a CL NC</option>
<option value="Llamadas de seguimiento">Llamadas de seguimiento</option>
</select>
</div>
<div class="form-group">
<label>Tipo de Aplicaci√≥n:</label>
<select id="tipoAplicacion">
<option value="">Seleccione tipo de aplicaci√≥n</option>
<option value="VISA U">VISA U</option>
<option value="VISA T">VISA T</option>
<option value="VISA K">VISA K</option>
<option value="VAWA">VAWA</option>
<option value="VAWA DA">VAWA DA</option>
<option value="VAWA AOS">VAWA AOS</option>
<option value="VAWA COURT">VAWA COURT</option>
<option value="AOS 245">AOS 245</option>
<option value="CERT OF CITIZENSHIP N600">CERT OF CITIZENSHIP N600</option>
<option value="CERT U">CERT U</option>
<option value="CONSULAR PROCESS WAIVER">CONSULAR PROCESS WAIVER</option>
<option value="CONSULAR PROCESS">CONSULAR PROCESS</option>
<option value="FOIA CBP">FOIA CBP</option>
<option value="FOIA USCIS">FOIA USCIS</option>
<option value="FOIA FBI">FOIA FBI</option>
<option value="FOIA ICE">FOIA ICE</option>
<option value="GREEN CARD RENEWAL I90">GREEN CARD RENEWAL I90</option>
<option value="NATURALIZATION N400">NATURALIZATION N400</option>
<option value="PIP">PIP</option>
<option value="PIP AOS">PIP AOS</option>
<option value="REG AOS">REG AOS</option>
<option value="REMOVAL OF CONDITIONS I751">REMOVAL OF CONDITIONS I751</option>
<option value="REPOSICION NATURALIZATION">REPOSICION NATURALIZATION</option>
<option value="EAD REPLACEMENT">EAD REPLACEMENT</option>
<option value="EAD RENEWAL">EAD RENEWAL</option>
</select>
</div>
</div>

<div class="section">
<h2 class="section-title">SECCI√ìN 3: DATOS DEL EVALUADOR</h2>
<div class="form-group">
<label>Evaluador:</label>
<select id="nombreEvaluador">
<option value="">Seleccione</option>
<option value="JOHAM OMAR BURGOS ROSALES">JOHAM OMAR BURGOS ROSALES</option>
<option value="DIEGO ROMO JUAREZ">DIEGO ROMO JUAREZ</option>
<option value="SOFIA ANALUZ VAZQUEZ COTERO">SOFIA ANALUZ VAZQUEZ COTERO</option>
<option value="BRENDA DOMINGUEZ MENDOZA">BRENDA DOMINGUEZ MENDOZA</option>
<option value="ANDREA ZENDEJAS MORALES">ANDREA ZENDEJAS MORALES</option>
<option value="MARIANA DIAZ FERRUSQUIA">MARIANA DIAZ FERRUSQUIA</option>
<option value="LUCIO JOAQUIN GUTIERREZ URBINA">LUCIO JOAQUIN GUTIERREZ URBINA</option>
<option value="LUCIA MICHELLE CORZAS CORONA">LUCIA MICHELLE CORZAS CORONA</option>
<option value="NIDIA CONSUELO NAVA GARCIA">NIDIA CONSUELO NAVA GARCIA</option>
<option value="LAURA KAREN REYNA CASTRO">LAURA KAREN REYNA CASTRO</option>
<option value="LUZ DEL CARMEN VERA RIVERA">LUZ DEL CARMEN VERA RIVERA</option>
<option value="BERENICE CELIS">BERENICE CELIS</option>
</select>
</div>
<div class="two-column">
<div class="form-group">
<label>Cargo:</label>
<select id="cargoEvaluador">
<option value="">Seleccione</option>
<option value="Trainer">Trainer</option>
<option value="Dise√±o Instruccional">Dise√±o Instruccional</option>
<option value="Manager">Manager</option>
</select>
</div>
<div class="form-group">
<label>Manager:</label>
<input type="text" id="managerEvaluador" value="Berenice Celis" readonly />
</div>
</div>
<div class="form-group">
<label>Fecha:</label>
<input type="date" id="fechaEvaluacion" />
</div>
</div>

<div class="section">
<h2 class="section-title">SECCI√ìN 4: CRITERIOS (1-16)</h2>

        <!-- Criterio 1 -->
        <div class="criteria-item">
          <div class="criteria-title">1. Capacidad de detectar y alinearse al estado emocional del cliente en la llamada</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio1" id="c1_cumple" value="cumple">
            <label for="c1_cumple"><strong>Cumple:</strong> Identifica c√≥mo llega el cliente (ansioso, serio, distra√≠do, apagado, enojado) y ajusta su tono, energ√≠a y ritmo para generar conexi√≥n desde el inicio.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio1" id="c1_no_cumple" value="no_cumple">
            <label for="c1_no_cumple"><strong>No cumple:</strong> Inicia plano, ap√°tico o r√≠gido, sin adaptar su energ√≠a al estado del cliente.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio1" id="c1_no_aplica" value="no_aplica">
            <label for="c1_no_aplica"><strong>No aplica:</strong> No realiza aperturas.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios1" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 2 -->
        <div class="criteria-item">
          <div class="criteria-title">2. Tono profesional, din√°mico y conectado</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio2" id="c2_cumple" value="cumple">
            <label for="c2_cumple"><strong>Cumple:</strong> Modula la voz con energ√≠a, calidez y profesionalismo para mantener la atenci√≥n del cliente.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio2" id="c2_no_cumple" value="no_cumple">
            <label for="c2_no_cumple"><strong>No cumple:</strong> Tono mon√≥tono, distante o inapropiado.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio2" id="c2_no_aplica" value="no_aplica">
            <label for="c2_no_aplica"><strong>No aplica:</strong> No interact√∫a por voz con clientes.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios2" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 3 -->
        <div class="criteria-item">
          <div class="criteria-title">3. Comunica de manera clara, directa y sin saturar al cliente</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio3" id="c3_cumple" value="cumple">
            <label for="c3_cumple"><strong>Cumple:</strong> Da instrucciones de forma clara, concreta y entendible, priorizando informaci√≥n que el caso realmente necesita.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio3" id="c3_no_cumple" value="no_cumple">
            <label for="c3_no_cumple"><strong>No cumple:</strong> Explica con rodeos, se extiende demasiado o genera confusi√≥n.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio3" id="c3_no_aplica" value="no_aplica">
            <label for="c3_no_aplica"><strong>No aplica:</strong> No brinda instrucciones al cliente.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios3" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 4 -->
        <div class="criteria-item">
          <div class="criteria-title">4. Empat√≠a modulada Vs situaci√≥n emocional del cliente</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio4" id="c4_cumple" value="cumple">
            <label for="c4_cumple"><strong>Cumple:</strong> Aplica empat√≠a vocal efectiva, modulando el tono para acompa√±ar la emoci√≥n del cliente.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio4" id="c4_no_cumple" value="no_cumple">
            <label for="c4_no_cumple"><strong>No cumple:</strong> Responde con frases planas sin modular su tono de voz.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio4" id="c4_no_aplica" value="no_aplica">
            <label for="c4_no_aplica"><strong>No aplica:</strong> No recibe este tipo de relatos.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios4" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 5 -->
        <div class="criteria-item">
          <div class="criteria-title">5. Control estrat√©gico y sin permisividad</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio5" id="c5_cumple" value="cumple">
            <label for="c5_cumple"><strong>Cumple:</strong> Gu√≠a la conversaci√≥n con una t√°ctica orientada a obtener elementos que fortalezcan el caso.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio5" id="c5_no_cumple" value="no_cumple">
            <label for="c5_no_cumple"><strong>No cumple:</strong> Permite desorden, pierde el control o deja que el cliente marque el rumbo.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio5" id="c5_no_aplica" value="no_aplica">
            <label for="c5_no_aplica"><strong>No aplica:</strong> No gestiona llamadas.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios5" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 6 -->
        <div class="criteria-item">
          <div class="criteria-title">6. Solicita evidencia estrat√©gica explicando el "51%" y la necesidad de subir la credibilidad</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio6" id="c6_cumple" value="cumple">
            <label for="c6_cumple"><strong>Cumple:</strong> Menciona la regla del 51% y pide documentos adicionales, explicando que sirven para fortalecer el caso.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio6" id="c6_no_cumple" value="no_cumple">
            <label for="c6_no_cumple"><strong>No cumple:</strong> No explica el 51%, no solicita evidencia adicional o lo hace de forma vaga.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio6" id="c6_no_aplica" value="no_aplica">
            <label for="c6_no_aplica"><strong>No aplica:</strong> No gestiona llamadas o casos que requieran evidencia estrat√©gica.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios6" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 7 -->
        <div class="criteria-item">
          <div class="criteria-title">7. Escucha activa y retoma informaci√≥n clave</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio7" id="c7_cumple" value="cumple">
            <label for="c7_cumple"><strong>Cumple:</strong> Retoma las palabras e ideas del cliente, muestra que escucha y usa esa informaci√≥n para avanzar.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio7" id="c7_no_cumple" value="no_cumple">
            <label for="c7_no_cumple"><strong>No cumple:</strong> No retoma nada, interrumpe o demuestra desconexi√≥n.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio7" id="c7_no_aplica" value="no_aplica">
            <label for="c7_no_aplica"><strong>No aplica:</strong> No realiza escucha activa en su rol.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios7" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 8 -->
        <div class="criteria-item">
          <div class="criteria-title">8. Genera acci√≥n inmediata en la entrega de documentaci√≥n</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio8" id="c8_cumple" value="cumple">
            <label for="c8_cumple"><strong>Cumple:</strong> Explica con claridad qu√© documento se necesita hoy, qu√© riesgo evita y c√≥mo afecta el avance del caso ("si me lo manda hoy mismo, avanzamos hoy mismo").</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio8" id="c8_no_cumple" value="no_cumple">
            <label for="c8_no_cumple"><strong>No cumple:</strong> No explica urgencia, no da razones o no impulsa acci√≥n.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio8" id="c8_no_aplica" value="no_aplica">
            <label for="c8_no_aplica"><strong>No aplica:</strong> No solicita documentaci√≥n.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios8" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 9 -->
        <div class="criteria-item">
          <div class="criteria-title">9. Obtiene informaci√≥n cr√≠tica del evento (7 Oros)</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio9" id="c9_cumple" value="cumple">
            <label for="c9_cumple"><strong>Cumple:</strong> Obtiene qui√©n, qu√© ocurri√≥, cu√°ndo, d√≥nde, c√≥mo fue, qu√© afectaci√≥n tuvo y si hay evidencia.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio9" id="c9_no_cumple" value="no_cumple">
            <label for="c9_no_cumple"><strong>No cumple:</strong> Deja huecos importantes o no construye la narrativa completa.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio9" id="c9_no_aplica" value="no_aplica">
            <label for="c9_no_aplica"><strong>No aplica:</strong> No recopila narrativa TVPA/abuso.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios9" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 10 -->
        <div class="criteria-item">
          <div class="criteria-title">10. Identificar agravantes y posibles evidencias</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio10" id="c10_cumple" value="cumple">
            <label for="c10_cumple"><strong>Cumple:</strong> Formula preguntas que revelan agravantes (control, repetici√≥n, amenazas, dinero, aislamiento) y evidencia potencial.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio10" id="c10_no_cumple" value="no_cumple">
            <label for="c10_no_cumple"><strong>No cumple:</strong> Hace preguntas generales, no profundiza o no busca agravantes.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio10" id="c10_no_aplica" value="no_aplica">
            <label for="c10_no_aplica"><strong>No aplica:</strong> No entrevista sobre abuso.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios10" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 11 -->
        <div class="criteria-item">
          <div class="criteria-title">11. Solicita evidencia disponible y gu√≠a al cliente para enviarla durante la llamada</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio11" id="c11_cumple" value="cumple">
            <label for="c11_cumple"><strong>Cumple:</strong> Pregunta si el cliente tiene la evidencia en ese momento y lo acompa√±a para enviarla durante la llamada.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio11" id="c11_no_cumple" value="no_cumple">
            <label for="c11_no_cumple"><strong>No cumple:</strong> No solicita evidencia o la deja para despu√©s sin intenci√≥n real.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio11" id="c11_no_aplica" value="no_aplica">
            <label for="c11_no_aplica"><strong>No aplica:</strong> No solicita documentos.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios11" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 12 -->
        <div class="criteria-item">
          <div class="criteria-title">12. Ofrece asistencia adicional para comparecer a instituciones por documentos</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio12" id="c12_cumple" value="cumple">
            <label for="c12_cumple"><strong>Cumple:</strong> Menciona que puede ayudarle a obtener los documentos o asistirle con instrucciones b√°sicas.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio12" id="c12_no_cumple" value="no_cumple">
            <label for="c12_no_cumple"><strong>No cumple:</strong> No ofrece apoyo, no explica procesos o deja toda la carga al cliente sin acompa√±amiento.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio12" id="c12_no_aplica" value="no_aplica">
            <label for="c12_no_aplica"><strong>No aplica:</strong> No se requiere comparecencia a instituciones.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios12" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 13 -->
        <div class="criteria-item">
          <div class="criteria-title">13. Manejo √©tico sin prometer resultados o tiempos</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio13" id="c13_cumple" value="cumple">
            <label for="c13_cumple"><strong>Cumple:</strong> Explica el proceso de forma realista y evita prometer tiempos o aprobaciones fuera de su control.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio13" id="c13_no_cumple" value="no_cumple">
            <label for="c13_no_cumple"><strong>No cumple:</strong> Hace promesas o genera expectativas irreales.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio13" id="c13_no_aplica" value="no_aplica">
            <label for="c13_no_aplica"><strong>No aplica:</strong> No maneja temas migratorios frente al cliente.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios13" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 14 -->
        <div class="criteria-item">
          <div class="criteria-title">14. L√≠mites profesionales y usa disclaimers de forma correcta</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio14" id="c14_cumple" value="cumple">
            <label for="c14_cumple"><strong>Cumple:</strong> Se mantiene firme pero emp√°tico y utiliza los disclaimers correspondientes.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio14" id="c14_no_cumple" value="no_cumple">
            <label for="c14_no_cumple"><strong>No cumple:</strong> No usa disclaimers, es permisivo o se sale del rol profesional.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio14" id="c14_no_aplica" value="no_aplica">
            <label for="c14_no_aplica"><strong>No aplica:</strong> Su rol no requiere disclaimers.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios14" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 15 -->
        <div class="criteria-item">
          <div class="criteria-title">15. Utiliza el fondo institucional aprobado durante la videollamada</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio15" id="c15_cumple" value="cumple">
            <label for="c15_cumple"><strong>Cumple:</strong> Usa el fondo institucional correcto, mantiene coherencia visual y profesionalismo.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio15" id="c15_no_cumple" value="no_cumple">
            <label for="c15_no_cumple"><strong>No cumple:</strong> Fondo personal, inapropiado o no institucional.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio15" id="c15_no_aplica" value="no_aplica">
            <label for="c15_no_aplica"><strong>No aplica:</strong> No realiza videollamadas.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios15" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>

        <!-- Criterio 16 -->
        <div class="criteria-item">
          <div class="criteria-title">16. C√≥digo de vestimenta semi formal adecuado para la interacci√≥n con el cliente</div>
          
          <div class="criteria-option option-cumple">
            <input type="radio" name="criterio16" id="c16_cumple" value="cumple">
            <label for="c16_cumple"><strong>Cumple:</strong> Viste de manera semiformal y presentable, proyectando profesionalismo en videollamada.</label>
          </div>
          
          <div class="criteria-option option-no-cumple">
            <input type="radio" name="criterio16" id="c16_no_cumple" value="no_cumple">
            <label for="c16_no_cumple"><strong>No cumple:</strong> Usa ropa inapropiada o demasiado informal.</label>
          </div>
          
          <div class="criteria-option option-no-aplica">
            <input type="radio" name="criterio16" id="c16_no_aplica" value="no_aplica">
            <label for="c16_no_aplica"><strong>No aplica:</strong> No tiene interacci√≥n visual con clientes.</label>
          </div>
          
          <div class="form-group" style="margin-top: 15px;">
            <label>Comentarios:</label>
            <textarea id="comentarios16" placeholder="Ingrese sus comentarios aqu√≠..."></textarea>
          </div>
        </div>
</div>

<div class="section" style="text-align:center;">
<button onclick="calcularResumen()" class="btn-primary" style="padding:16px 40px; font-size:18px;">
üìä Generar Resumen de Evaluaci√≥n
</button>
</div>

<div class="section" id="seccionResumen" style="display:none;">
<h2 class="section-title">SECCI√ìN 5: RESUMEN</h2>
<div class="summary-box">
<div class="summary-item"><strong>Total evaluados:</strong><span id="totalEvaluados">0</span></div>
<div class="summary-item"><strong>Cumplen:</strong><span id="totalCumplen">0</span></div>
<div class="summary-item"><strong>No cumplen:</strong><span id="totalNoCumplen">0</span></div>
<div class="summary-item"><strong>No aplican:</strong><span id="totalNoAplican">0</span></div>
<div class="summary-item"><strong>% Cumplimiento:</strong><span id="porcentajeCumplimiento">0%</span></div>
</div>

<div style="margin-top:30px;">
<div style="background:#e8f5e9; padding:20px; border-radius:8px; margin-bottom:20px; border-left:4px solid #28a745;">
<h3 style="color:#28a745; margin-bottom:15px;">‚úì Criterios que Cumplen:</h3>
<ul id="listaCumplen" style="margin-left:20px;"><li style="color:#999;">Ninguno</li></ul>
</div>
<div style="background:#ffebee; padding:20px; border-radius:8px; margin-bottom:20px; border-left:4px solid #dc3545;">
<h3 style="color:#dc3545; margin-bottom:15px;">‚úó Criterios que No Cumplen:</h3>
<ul id="listaNoCumplen" style="margin-left:20px;"><li style="color:#999;">Ninguno</li></ul>
</div>
<div style="background:#f5f5f5; padding:20px; border-radius:8px; border-left:4px solid #6c757d;">
<h3 style="color:#6c757d; margin-bottom:15px;">‚äò Criterios que No Aplican:</h3>
<ul id="listaNoAplican" style="margin-left:20px;"><li style="color:#999;">Ninguno</li></ul>
</div>
</div>
</div>

<div class="section" id="seccionObservaciones" style="display:none;">
<h2 class="section-title">SECCI√ìN 6: COMENTARIOS Y PLAN DE MEJORA</h2>
<div style="background:#f8f9fa; padding:20px; border-radius:8px; margin-bottom:20px;">
<h3 style="color:#667eea; margin-bottom:15px;">üìù Comentarios de Criterios:</h3>
<div id="resumenComentarios"></div>
</div>
<div class="form-group">
<label>Propuesta de Mejora:</label>
<textarea id="propuestaMejora" rows="6" placeholder="Describa acciones espec√≠ficas de mejora..."></textarea>
</div>
</div>

<div class="button-container" id="botonesAccion" style="display:none;">
<button onclick="window.print()" class="btn-primary">üìÑ Imprimir PDF</button>
<button onclick="enviarASheets()" class="btn-primary">üìä Guardar en Google Sheets</button>
<button onclick="limpiarFormulario()" class="btn-secondary">üîÑ Limpiar Formulario</button>
</div>

</div>
</div>

<script>
const scriptURL = 'https://script.google.com/macros/s/AKfycbwhKJn5ci2dZ3CdCLIz8afuoBZzsDgzAGGLT4-WAd-JgtRS_wW_t3Jga-qY0t-vZhCY/exec';
let catalogoColaboradores = [];

function getVal(id) {
  const el = document.getElementById(id);
  return el ? el.value : '';
}

function getText(id) {
  const el = document.getElementById(id);
  return el ? el.textContent : '';
}

document.addEventListener('DOMContentLoaded', function() {
  const f = document.getElementById('fechaEvaluacion');
  if (f) {
    const d = new Date();
    f.value = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
  }
  cargarCatalogoColaboradores();
  setupAutoCargoEvaluador();
});

function cargarCatalogoColaboradores() {
  const select = document.getElementById('idColaborador');
  select.innerHTML = '<option value="">Cargando colaboradores...</option>';

  fetch(`${scriptURL}?action=getColaboradores`)
    .then(r => r.json())
    .then(data => {
      catalogoColaboradores = Array.isArray(data) ? data : [];
      
      // Ordenar alfab√©ticamente por nombre (A-Z)
      catalogoColaboradores.sort((a, b) => {
        const nameA = (a.nombreColaborador || '').toUpperCase();
        const nameB = (b.nombreColaborador || '').toUpperCase();
        return nameA.localeCompare(nameB);
      });
      
      select.innerHTML = '<option value="">Selecciona colaborador</option>';
      
      catalogoColaboradores.forEach(c => {
        const opt = document.createElement('option');
        opt.value = c.idColaborador || c.nombreColaborador;
        opt.textContent = c.nombreColaborador;
        select.appendChild(opt);
      });
      
      select.addEventListener('change', autollenarColaborador);
    })
    .catch(err => {
      console.error('Error:', err);
      select.innerHTML = '<option value="">‚ö†Ô∏è Error cargando</option>';
    });
}

function autollenarColaborador() {
  const id = getVal('idColaborador');
  const c = catalogoColaboradores.find(x => String(x.idColaborador || x.nombreColaborador).trim() === String(id).trim());
  if (!c) return;
  
  document.getElementById('nombreColaborador').value = c.nombreColaborador || '';
  document.getElementById('areaColaborador').value = c.areaColaborador || '';
  document.getElementById('teamLeader').value = c.teamLeaderColaborador || '';
  document.getElementById('managerColaborador').value = c.managerColaborador || '';
}

function setupAutoCargoEvaluador() {
  const nombreEvaluador = document.getElementById('nombreEvaluador');
  const cargoEvaluador = document.getElementById('cargoEvaluador');
  
  const cargosMap = {
    'JOHAM OMAR BURGOS ROSALES': 'Trainer',
    'DIEGO ROMO JUAREZ': 'Trainer',
    'SOFIA ANALUZ VAZQUEZ COTERO': 'Trainer',
    'BRENDA DOMINGUEZ MENDOZA': 'Trainer',
    'ANDREA ZENDEJAS MORALES': 'Trainer',
    'MARIANA DIAZ FERRUSQUIA': 'Trainer',
    'LUCIO JOAQUIN GUTIERREZ URBINA': 'Trainer',
    'LUCIA MICHELLE CORZAS CORONA': 'Trainer',
    'NIDIA CONSUELO NAVA GARCIA': 'Trainer',
    'LAURA KAREN REYNA CASTRO': 'Dise√±o Instruccional',
    'LUZ DEL CARMEN VERA RIVERA': 'Dise√±o Instruccional',
    'BERENICE CELIS': 'Manager'
  };
  
  nombreEvaluador.addEventListener('change', function() {
    if (cargosMap[this.value]) cargoEvaluador.value = cargosMap[this.value];
  });
}

function calcularResumen() {
  let totalCumplen = 0, totalNoCumplen = 0, totalNoAplican = 0, totalEvaluados = 0;
  let criteriosSinResponder = [], criteriosCumplen = [], criteriosNoCumplen = [], criteriosNoAplican = [];
  let comentariosHTML = '';
  
  const nombresCriterios = [
    "Capacidad de detectar y alinearse al estado emocional del cliente",
    "Tono profesional, din√°mico y conectado",
    "Comunica de manera clara, directa y sin saturar",
    "Empat√≠a modulada Vs situaci√≥n emocional del cliente",
    "Control estrat√©gico y sin permisividad",
    "Solicita evidencia estrat√©gica explicando el 51%",
    "Escucha activa y retoma informaci√≥n clave",
    "Genera acci√≥n inmediata en la entrega de documentaci√≥n",
    "Obtiene informaci√≥n cr√≠tica del evento (7 Oros)",
    "Identificar agravantes y posibles evidencias",
    "Solicita evidencia disponible y gu√≠a al cliente",
    "Ofrece asistencia adicional para comparecer a instituciones",
    "Manejo √©tico sin prometer resultados o tiempos",
    "L√≠mites profesionales y usa disclaimers",
    "Utiliza el fondo institucional aprobado",
    "C√≥digo de vestimenta semi formal adecuado"
  ];
  
  for (let i = 1; i <= 16; i++) {
    const radios = document.getElementsByName('criterio' + i);
    const comentarioEl = document.getElementById('comentarios' + i);
    const comentario = comentarioEl ? comentarioEl.value.trim() : '';
    let criterioEvaluado = false, estadoCriterio = '';
    
    for (let radio of radios) {
      if (radio.checked) {
        criterioEvaluado = true;
        estadoCriterio = radio.value;
        if (radio.value === 'cumple') {
          totalCumplen++;
          criteriosCumplen.push(`${i}. ${nombresCriterios[i-1]}`);
        } else if (radio.value === 'no_cumple') {
          totalNoCumplen++;
          criteriosNoCumplen.push(`${i}. ${nombresCriterios[i-1]}`);
        } else if (radio.value === 'no_aplica') {
          totalNoAplican++;
          criteriosNoAplican.push(`${i}. ${nombresCriterios[i-1]}`);
        }
        break;
      }
    }
    
    if (criterioEvaluado) {
      totalEvaluados++;
      if (comentario) {
        let colorBadge = estadoCriterio === 'cumple' ? '#28a745' : estadoCriterio === 'no_cumple' ? '#dc3545' : '#6c757d';
        let textoEstado = estadoCriterio === 'cumple' ? 'Cumple' : estadoCriterio === 'no_cumple' ? 'No Cumple' : 'No Aplica';
        comentariosHTML += `<div style="margin-bottom:15px; padding:12px; background:white; border-radius:6px; border-left:4px solid ${colorBadge};">
<div style="display:flex; align-items:center; gap:10px; margin-bottom:8px;">
<strong>Criterio ${i}:</strong>
<span style="background:${colorBadge}; color:white; padding:3px 10px; border-radius:12px; font-size:12px;">${textoEstado}</span>
</div>
<div style="color:#666; font-size:14px; font-style:italic;">${nombresCriterios[i-1]}</div>
<div style="margin-top:8px;">${comentario}</div>
</div>`;
      }
    } else {
      criteriosSinResponder.push(i);
    }
  }
  
  if (criteriosSinResponder.length > 0) {
    alert('‚ö†Ô∏è Debe evaluar todos los criterios.\nCriterios sin responder: ' + criteriosSinResponder.join(', '));
    return;
  }
  
  const criteriosAplicables = totalEvaluados - totalNoAplican;
  const porcentaje = criteriosAplicables > 0 ? Math.round((totalCumplen / criteriosAplicables) * 100) : 0;
  
  document.getElementById('totalEvaluados').textContent = totalEvaluados;
  document.getElementById('totalCumplen').textContent = totalCumplen;
  document.getElementById('totalNoCumplen').textContent = totalNoCumplen;
  document.getElementById('totalNoAplican').textContent = totalNoAplican;
  document.getElementById('porcentajeCumplimiento').textContent = porcentaje + '%';
  
  document.getElementById('listaCumplen').innerHTML = criteriosCumplen.length ? criteriosCumplen.map(c => `<li>${c}</li>`).join('') : '<li style="color:#999;">Ninguno</li>';
  document.getElementById('listaNoCumplen').innerHTML = criteriosNoCumplen.length ? criteriosNoCumplen.map(c => `<li>${c}</li>`).join('') : '<li style="color:#999;">Ninguno</li>';
  document.getElementById('listaNoAplican').innerHTML = criteriosNoAplican.length ? criteriosNoAplican.map(c => `<li>${c}</li>`).join('') : '<li style="color:#999;">Ninguno</li>';
  
  document.getElementById('resumenComentarios').innerHTML = comentariosHTML || '<p style="color:#999;">No hay comentarios.</p>';
  
  document.getElementById('seccionResumen').style.display = 'block';
  document.getElementById('seccionObservaciones').style.display = 'block';
  document.getElementById('botonesAccion').style.display = 'flex';
  
  setTimeout(() => document.getElementById('seccionResumen').scrollIntoView({ behavior:'smooth' }), 100);
  alert('‚úÖ Resumen calculado exitosamente.');
}

function enviarASheets() {
  const seccionResumen = document.getElementById('seccionResumen');
  if (seccionResumen && seccionResumen.style.display !== 'block') {
    if (!confirm('A√∫n no se ha calculado el resumen.\n\n¬øEnviar de todos modos?')) return;
  }
  
  const data = {
    fechaEvaluacion: getVal('fechaEvaluacion'),
    nombreColaborador: getVal('nombreColaborador'),
    areaColaborador: getVal('areaColaborador'),
    teamLeaderColaborador: getVal('teamLeader'),
    managerColaborador: getVal('managerColaborador'),
    nombreCliente: getVal('nombreCliente'),
    tipoLlamada: getVal('tipoLlamada'),
    tipoAplicacion: getVal('tipoAplicacion'),
    nombreEvaluador: getVal('nombreEvaluador'),
    cargoEvaluador: getVal('cargoEvaluador'),
    managerEvaluador: getVal('managerEvaluador'),
    totalEvaluados: getText('totalEvaluados') || '0',
    totalCumple: getText('totalCumplen') || '0',
    totalNoCumple: getText('totalNoCumplen') || '0',
    totalNoAplica: getText('totalNoAplican') || '0',
    puntajeFinal: (getText('porcentajeCumplimiento') || '0').replace('%','').trim(),
    propuestaMejora: getVal('propuestaMejora')
  };
  
  for (let i = 1; i <= 16; i++) {
    const radios = document.getElementsByName('criterio' + i);
    let valor = '';
    if (radios) {
      for (const r of radios) {
        if (r.checked) { valor = r.value; break; }
      }
    }
    data['criterio' + i + '_evaluacion'] = valor;
    data['criterio' + i + '_comentarios'] = getVal('comentarios' + i);
  }
  
  fetch(scriptURL, {
    method: 'POST',
    mode: 'no-cors',
    headers: {'Content-Type': 'text/plain;charset=utf-8'},
    body: JSON.stringify(data)
  })
  .then(() => alert('‚úÖ Evaluaci√≥n enviada (verifica la Google Sheet).'))
  .catch(err => {
    console.error('Error:', err);
    alert('‚ö†Ô∏è Error al enviar.');
  });
}

function limpiarFormulario() {
  if (!confirm('¬øLimpiar todo el formulario?')) return;
  
  document.querySelectorAll('input[type="text"], input[type="date"], textarea').forEach(i => {
    if (i.id !== 'managerEvaluador') i.value = '';
  });
  document.querySelectorAll('select').forEach(s => s.selectedIndex = 0);
  document.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
  
  document.getElementById('totalEvaluados').textContent = '0';
  document.getElementById('totalCumplen').textContent = '0';
  document.getElementById('totalNoCumplen').textContent = '0';
  document.getElementById('totalNoAplican').textContent = '0';
  document.getElementById('porcentajeCumplimiento').textContent = '0%';
  
  document.getElementById('seccionResumen').style.display = 'none';
  document.getElementById('seccionObservaciones').style.display = 'none';
  document.getElementById('botonesAccion').style.display = 'none';
  
  cargarCatalogoColaboradores();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}
</script>
</body>
</html>
